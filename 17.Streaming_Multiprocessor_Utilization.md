# SM 利用率 （Streaming Multiprocessor Utilization）

SM 利用率（SM utilization）衡量的是 Streaming Multiprocessor（流式多处理器，简称 SM）执行指令的时间占比。

SM 利用率类似于 nvidia-smi 显示的 GPU “内核利用率（kernel utilization）”，但粒度更细。
nvidia-smi 只报告 “整个 GPU 上是否有 kernel 在跑” 的时间比例，而 SM 利用率报告的是所有 SM 共同处于执行状态的时间比例。

例如：
- 如果一个 kernel 只使用 一个 SM（比如它只包含一个 thread block）
- 那么它在运行期间可能显示 100% GPU 利用率（nvidia-smi），
- 但 SM 利用率最多只有：1 / SM 总数量

（即 nvidia-smi 显示 100% 并不意味着 SM 利用率是 100%）

# SM 利用率 $\neq$ GPU 资源利用率

尽管 SM 利用率已经比 GPU 利用率更精细，但它仍不足以衡量 GPU 计算资源的利用情况。

如果 SM 利用率很高，但性能仍然很低，那么程序员应该查看 pipe utilization（功能单元/执行管线利用率）：
- pipe utilization 低 → SM 内部计算单元闲置
- SM utilization 高 → kernel 正在 SM 上运行

两者结合的意义：
- 高 SM utilization + 低 pipe utilization
- 表示 kernel 虽然在许多 SM 上运行，但 每个 SM 内部的计算资源没有被充分利用（例如 warp 发射效率低、访存 stall 多、指令吞吐不足等）。